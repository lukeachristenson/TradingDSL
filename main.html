<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html><head><meta http-equiv="content-type" content="text/html; charset=utf-8"/><meta name="viewport" content="width=device-width, initial-scale=0.8"/><title>TradingDSL: A Domain-Specific Language for Trading Strategy Development</title><link rel="stylesheet" type="text/css" href="scribble.css" title="default"/><link rel="stylesheet" type="text/css" href="racket.css" title="default"/><link rel="stylesheet" type="text/css" href="manual-style.css" title="default"/><link rel="stylesheet" type="text/css" href="manual-racket.css" title="default"/><script type="text/javascript" src="scribble-common.js"></script><script type="text/javascript" src="manual-racket.js"></script><!--[if IE 6]><style type="text/css">.SIEHidden { overflow: hidden; }</style><![endif]--></head><body id="scribble-racket-lang-org"><div class="tocset"><div class="tocview"><div class="tocviewlist tocviewlisttopspace"><div class="tocviewtitle"><table cellspacing="0" cellpadding="0"><tr><td style="width: 1em;"><a href="javascript:void(0);" title="Expand/Collapse" class="tocviewtoggle" onclick="TocviewToggle(this,&quot;tocview_0&quot;);">&#9658;</a></td><td></td><td><a href="file:///Users/smarant/Documents/University%20stuff/Spring%202025/CS%203620%20-%20HYOL/TradingDSL/main.html" class="tocviewselflink" data-pltdoc="x">Trading<span class="mywbr"> &nbsp;</span>DSL:<span class="mywbr"> &nbsp;</span> A Domain-<wbr></wbr>Specific Language for Trading Strategy Development</a></td></tr></table></div><div class="tocviewsublistonly" style="display: none;" id="tocview_0"><table cellspacing="0" cellpadding="0"><tr><td align="right">1&nbsp;</td><td><a href="file:///Users/smarant/Documents/University%20stuff/Spring%202025/CS%203620%20-%20HYOL/TradingDSL/main.html#%28part._.Introduction%29" class="tocviewlink" data-pltdoc="x">Introduction</a></td></tr><tr><td align="right">2&nbsp;</td><td><a href="file:///Users/smarant/Documents/University%20stuff/Spring%202025/CS%203620%20-%20HYOL/TradingDSL/main.html#%28part._.Key_.Concepts%29" class="tocviewlink" data-pltdoc="x">Key Concepts</a></td></tr><tr><td align="right">3&nbsp;</td><td><a href="file:///Users/smarant/Documents/University%20stuff/Spring%202025/CS%203620%20-%20HYOL/TradingDSL/main.html#%28part._.Macro-.Based_.Interface%29" class="tocviewlink" data-pltdoc="x">Macro-<wbr></wbr>Based Interface</a></td></tr><tr><td align="right">4&nbsp;</td><td><a href="file:///Users/smarant/Documents/University%20stuff/Spring%202025/CS%203620%20-%20HYOL/TradingDSL/main.html#%28part._.Function-.Based_.Interface%29" class="tocviewlink" data-pltdoc="x">Function-<wbr></wbr>Based Interface</a></td></tr><tr><td align="right">5&nbsp;</td><td><a href="file:///Users/smarant/Documents/University%20stuff/Spring%202025/CS%203620%20-%20HYOL/TradingDSL/main.html#%28part._.Strategy_.Building_.Blocks%29" class="tocviewlink" data-pltdoc="x">Strategy Building Blocks</a></td></tr><tr><td align="right">6&nbsp;</td><td><a href="file:///Users/smarant/Documents/University%20stuff/Spring%202025/CS%203620%20-%20HYOL/TradingDSL/main.html#%28part._.Data_.Structures%29" class="tocviewlink" data-pltdoc="x">Data Structures</a></td></tr><tr><td align="right">7&nbsp;</td><td><a href="file:///Users/smarant/Documents/University%20stuff/Spring%202025/CS%203620%20-%20HYOL/TradingDSL/main.html#%28part._.Time_.Period_.Constants%29" class="tocviewlink" data-pltdoc="x">Time Period Constants</a></td></tr><tr><td align="right">8&nbsp;</td><td><a href="file:///Users/smarant/Documents/University%20stuff/Spring%202025/CS%203620%20-%20HYOL/TradingDSL/main.html#%28part._.Visualization_.Functions%29" class="tocviewlink" data-pltdoc="x">Visualization Functions</a></td></tr></table></div></div></div><div class="tocsub"><table class="tocsublist" cellspacing="0"><tr><td><span class="tocsublinknumber"></span><a href="#%28part._.Trading.D.S.L__.A_.Domain-.Specific_.Language_for_.Trading_.Strategy_.Development%29" class="tocsubseclink" data-pltdoc="x">Trading<span class="mywbr"> &nbsp;</span>DSL:<span class="mywbr"> &nbsp;</span> A Domain-<wbr></wbr>Specific Language for Trading Strategy Development</a></td></tr><tr><td><span class="tocsublinknumber">1<tt>&nbsp;</tt></span><a href="#%28part._.Introduction%29" class="tocsubseclink" data-pltdoc="x">Introduction</a></td></tr><tr><td><span class="tocsublinknumber">2<tt>&nbsp;</tt></span><a href="#%28part._.Key_.Concepts%29" class="tocsubseclink" data-pltdoc="x">Key Concepts</a></td></tr><tr><td><span class="tocsublinknumber">2.1<tt>&nbsp;</tt></span><a href="#%28part._.Strategies%29" class="tocsubseclink" data-pltdoc="x">Strategies</a></td></tr><tr><td><span class="tocsublinknumber">2.2<tt>&nbsp;</tt></span><a href="#%28part._.Active_.Periods%29" class="tocsubseclink" data-pltdoc="x">Active Periods</a></td></tr><tr><td><span class="tocsublinknumber">2.3<tt>&nbsp;</tt></span><a href="#%28part._.Backtesting%29" class="tocsubseclink" data-pltdoc="x">Backtesting</a></td></tr><tr><td><span class="tocsublinknumber">3<tt>&nbsp;</tt></span><a href="#%28part._.Macro-.Based_.Interface%29" class="tocsubseclink" data-pltdoc="x">Macro-<wbr></wbr>Based Interface</a></td></tr><tr><td><a href="#%28form._%28%28lib._.Trading.D.S.L%2Fmain..rkt%29._define%2Fstrategy%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktStxLink">define/<span class="mywbr"> &nbsp;</span>strategy</span></span></a></td></tr><tr><td><a href="#%28form._%28%28lib._.Trading.D.S.L%2Fmain..rkt%29._define%2Fcombined-strategy%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktStxLink">define/<span class="mywbr"> &nbsp;</span>combined-<wbr></wbr>strategy</span></span></a></td></tr><tr><td><a href="#%28form._%28%28lib._.Trading.D.S.L%2Fmain..rkt%29._compose-strategies%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktStxLink">compose-<wbr></wbr>strategies</span></span></a></td></tr><tr><td><a href="#%28form._%28%28lib._.Trading.D.S.L%2Fmain..rkt%29._backtest%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktStxLink">backtest</span></span></a></td></tr><tr><td><span class="tocsublinknumber">4<tt>&nbsp;</tt></span><a href="#%28part._.Function-.Based_.Interface%29" class="tocsubseclink" data-pltdoc="x">Function-<wbr></wbr>Based Interface</a></td></tr><tr><td><a href="#%28def._%28%28lib._.Trading.D.S.L%2Fmain..rkt%29._strategy%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">strategy</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._.Trading.D.S.L%2Fmain..rkt%29._combined-strategy%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">combined-<wbr></wbr>strategy</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._.Trading.D.S.L%2Fmain..rkt%29._compose-strategies-fn%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">compose-<wbr></wbr>strategies-<wbr></wbr>fn</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._.Trading.D.S.L%2Fmain..rkt%29._backtest-fn%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">backtest-<wbr></wbr>fn</span></span></a></td></tr><tr><td><span class="tocsublinknumber">5<tt>&nbsp;</tt></span><a href="#%28part._.Strategy_.Building_.Blocks%29" class="tocsubseclink" data-pltdoc="x">Strategy Building Blocks</a></td></tr><tr><td><a href="#%28def._%28%28lib._.Trading.D.S.L%2Fmain..rkt%29._top-performer%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">top-<wbr></wbr>performer</span></span></a></td></tr><tr><td><span class="tocsublinknumber">6<tt>&nbsp;</tt></span><a href="#%28part._.Data_.Structures%29" class="tocsubseclink" data-pltdoc="x">Data Structures</a></td></tr><tr><td><a href="#%28def._%28%28lib._.Trading.D.S.L%2Fmain..rkt%29._ticker-weight%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">ticker-<wbr></wbr>weight</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._.Trading.D.S.L%2Fmain..rkt%29._reduced-date%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">reduced-<wbr></wbr>date</span></span></a></td></tr><tr><td><span class="tocsublinknumber">7<tt>&nbsp;</tt></span><a href="#%28part._.Time_.Period_.Constants%29" class="tocsubseclink" data-pltdoc="x">Time Period Constants</a></td></tr><tr><td><a href="#%28def._%28%28lib._.Trading.D.S.L%2Fmain..rkt%29._1y%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">1y</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._.Trading.D.S.L%2Fmain..rkt%29._6m%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">6m</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._.Trading.D.S.L%2Fmain..rkt%29._3m%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">3m</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._.Trading.D.S.L%2Fmain..rkt%29._1m%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">1m</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._.Trading.D.S.L%2Fmain..rkt%29._2w%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">2w</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._.Trading.D.S.L%2Fmain..rkt%29._1w%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">1w</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._.Trading.D.S.L%2Fmain..rkt%29._5d%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">5d</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._.Trading.D.S.L%2Fmain..rkt%29._1d%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">1d</span></span></a></td></tr><tr><td><span class="tocsublinknumber">8<tt>&nbsp;</tt></span><a href="#%28part._.Visualization_.Functions%29" class="tocsubseclink" data-pltdoc="x">Visualization Functions</a></td></tr><tr><td><a href="#%28def._%28%28lib._.Trading.D.S.L%2Fmain..rkt%29._display-strategy-allocation%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">display-<wbr></wbr>strategy-<wbr></wbr>allocation</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._.Trading.D.S.L%2Fmain..rkt%29._display-strategy-comparison%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">display-<wbr></wbr>strategy-<wbr></wbr>comparison</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._.Trading.D.S.L%2Fmain..rkt%29._display-allocation-difference%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">display-<wbr></wbr>allocation-<wbr></wbr>difference</span></span></a></td></tr></table></div></div><div class="maincolumn"><div class="main"><div class="versionbox"><span class="versionNoNav">8.15</span></div><h2 class="heading"><a name="(part._.Trading.D.S.L__.A_.Domain-.Specific_.Language_for_.Trading_.Strategy_.Development)"></a><a name="(mod-path._.Trading.D.S.L)"></a>TradingDSL: A Domain-Specific Language for Trading Strategy Development<span class="button-group"><a href="#(part._.Trading.D.S.L__.A_.Domain-.Specific_.Language_for_.Trading_.Strategy_.Development)" class="heading-anchor" title="Link to here">ðŸ”—</a><span style="visibility: hidden"> </span></span></h2><p><table cellspacing="0" cellpadding="0" class="defmodule"><tr><td align="left"><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><span class="badlink"><span class="RktValLink">require</span></span></span><span class="stt"> </span><a href="file:///Users/smarant/Documents/University%20stuff/Spring%202025/CS%203620%20-%20HYOL/TradingDSL/main.html" class="RktModLink" data-pltdoc="x"><span class="RktSym">TradingDSL</span></a><span class="RktPn">)</span></td><td align="right"><span class="RpackageSpec"><span class="Smaller">&nbsp;package:</span> <a href="https://pkgs.racket-lang.org/package/TradingDSL" title="Install this package using `raco pkg install TradingDSL`"><span class="stt">TradingDSL</span></a></span></td></tr></table></p><h3 class="heading">1<tt>&nbsp;</tt><a name="(part._.Introduction)"></a>Introduction<span class="button-group"><a href="#(part._.Introduction)" class="heading-anchor" title="Link to here">ðŸ”—</a><span style="visibility: hidden"> </span></span></h3><p>TradingDSL is a domain-specific language for defining, testing, and analyzing stock trading strategies. It provides a clean syntax for specifying strategies based on momentum and other factors, defining active periods for strategies, combining strategies, and backtesting.</p><p><div class="SIntrapara">The DSL is implemented in two complementary ways:
</div><div class="SIntrapara"><ul><li><p>A macro-based implementation using <span class="stt">syntax-spec</span> for compile-time validation</p></li><li><p>A function-based implementation providing similar capabilities with runtime checks</p></li></ul></div></p><p>Both implementations allow traders to express strategies concisely while ensuring important constraints like date validation are enforced.</p><h3 class="heading">2<tt>&nbsp;</tt><a name="(part._.Key_.Concepts)"></a>Key Concepts<span class="button-group"><a href="#(part._.Key_.Concepts)" class="heading-anchor" title="Link to here">ðŸ”—</a><span style="visibility: hidden"> </span></span></h3><h4 class="heading">2.1<tt>&nbsp;</tt><a name="(part._.Strategies)"></a>Strategies<span class="button-group"><a href="#(part._.Strategies)" class="heading-anchor" title="Link to here">ðŸ”—</a><span style="visibility: hidden"> </span></span></h4><p>A strategy in TradingDSL is a function that takes a date and returns a list of ticker-weight pairs, representing an allocation of stocks in a portfolio. The DSL provides macros and functions to define, compose, and test these strategies.</p><h4 class="heading">2.2<tt>&nbsp;</tt><a name="(part._.Active_.Periods)"></a>Active Periods<span class="button-group"><a href="#(part._.Active_.Periods)" class="heading-anchor" title="Link to here">ðŸ”—</a><span style="visibility: hidden"> </span></span></h4><p>Each strategy has an active period defined by start and end dates. This represents the time period for which the strategy is valid. The DSL enforces that strategies are only used within their active periods.</p><h4 class="heading">2.3<tt>&nbsp;</tt><a name="(part._.Backtesting)"></a>Backtesting<span class="button-group"><a href="#(part._.Backtesting)" class="heading-anchor" title="Link to here">ðŸ”—</a><span style="visibility: hidden"> </span></span></h4><p>Backtesting simulates running a strategy over a historical period to evaluate its performance. TradingDSL provides built-in backtesting functions that validate the test period against the strategy&rsquo;s active period.</p><h3 class="heading">3<tt>&nbsp;</tt><a name="(part._.Macro-.Based_.Interface)"></a>Macro-Based Interface<span class="button-group"><a href="#(part._.Macro-.Based_.Interface)" class="heading-anchor" title="Link to here">ðŸ”—</a><span style="visibility: hidden"> </span></span></h3><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>syntax</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(form._((lib._.Trading.D.S.L/main..rkt)._define/strategy))"></a><span title="Provided from: TradingDSL | Package: TradingDSL"><span class="RktSym"><a href="file:///Users/smarant/Documents/University%20stuff/Spring%202025/CS%203620%20-%20HYOL/TradingDSL/main.html#%28form._%28%28lib._.Trading.D.S.L%2Fmain..rkt%29._define%2Fstrategy%29%29" class="RktStxDef RktStxLink" data-pltdoc="x">define/strategy</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">id</span><span class="hspace">&nbsp;</span><span class="RktVar">strategy-expr</span><span class="hspace">&nbsp;</span><span class="RktPn">#:from</span><span class="hspace">&nbsp;</span><span class="RktVar">from-date</span><span class="hspace">&nbsp;</span><span class="RktPn">#:to</span><span class="hspace">&nbsp;</span><span class="RktVar">to-date</span><span class="RktPn">)</span></p></blockquote></td></tr></table></blockquote></div><div class="SIntrapara">Defines a new strategy with identifier <span class="RktVar">id</span>, implemented by <span class="RktVar">strategy-expr</span>, which should evaluate to a function that takes a date and returns a list of <span class="RktSym"><a href="file:///Users/smarant/Documents/University%20stuff/Spring%202025/CS%203620%20-%20HYOL/TradingDSL/main.html#%28def._%28%28lib._.Trading.D.S.L%2Fmain..rkt%29._ticker-weight%29%29" class="RktValLink" data-pltdoc="x">ticker-weight</a></span> structures.</div></p><p>The strategy is constrained to be active from <span class="RktVar">from-date</span> to <span class="RktVar">to-date</span>, which must be strings in the format "YYYY-MM-DD". Compile-time error checking ensures the end date is not before the start date.</p><p><div class="SIntrapara">Example:</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="file:///Users/smarant/Documents/University%20stuff/Spring%202025/CS%203620%20-%20HYOL/TradingDSL/main.html#%28form._%28%28lib._.Trading.D.S.L%2Fmain..rkt%29._define%2Fstrategy%29%29" class="RktStxLink" data-pltdoc="x">define/strategy</a></span><span class="hspace">&nbsp;</span><span class="RktSym">invalid-strategy</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><span class="badlink"><span class="RktValLink">lambda</span></span></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><span class="badlink"><span class="RktValLink">date</span></span></span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">(</span><span class="RktVal">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">#:from</span><span class="hspace">&nbsp;</span><span class="RktVal">"2023-12-31"</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">#:to</span><span class="hspace">&nbsp;</span><span class="RktVal">"2023-01-01"</span><span class="RktPn">)</span></td></tr></table></td></tr><tr><td><p><span class="RktErr">TradingDSL.rkt:110:26: invalid-period: Invalid date range</span></p></td></tr><tr><td><p><span class="RktErr">provided: end date is before start date</span></p></td></tr><tr><td><p><span class="RktErr"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktErr">in: start-date</span></p></td></tr></table></blockquote></div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>syntax</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(form._((lib._.Trading.D.S.L/main..rkt)._define/combined-strategy))"></a><span title="Provided from: TradingDSL | Package: TradingDSL"><span class="RktSym"><a href="file:///Users/smarant/Documents/University%20stuff/Spring%202025/CS%203620%20-%20HYOL/TradingDSL/main.html#%28form._%28%28lib._.Trading.D.S.L%2Fmain..rkt%29._define%2Fcombined-strategy%29%29" class="RktStxDef RktStxLink" data-pltdoc="x">define/combined-strategy</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">id</span><span class="hspace">&nbsp;</span><span class="RktVar">strategy1</span><span class="hspace">&nbsp;</span><span class="RktVar">strategy2</span><span class="hspace">&nbsp;</span><span class="RktPn">#:mid</span><span class="hspace">&nbsp;</span><span class="RktVar">mid-date</span><span class="RktPn">)</span></p></blockquote></td></tr></table></blockquote></div><div class="SIntrapara">Defines a new strategy that uses <span class="RktVar">strategy1</span> up to <span class="RktVar">mid-date</span> and then switches to <span class="RktVar">strategy2</span> afterward.</div></p><p>Compile-time checks ensure that the periods of <span class="RktVar">strategy1</span> and <span class="RktVar">strategy2</span> overlap at <span class="RktVar">mid-date</span>, and that <span class="RktVar">mid-date</span> is a valid date string in the format "YYYY-MM-DD".</p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>syntax</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(form._((lib._.Trading.D.S.L/main..rkt)._compose-strategies))"></a><span title="Provided from: TradingDSL | Package: TradingDSL"><span class="RktSym"><a href="file:///Users/smarant/Documents/University%20stuff/Spring%202025/CS%203620%20-%20HYOL/TradingDSL/main.html#%28form._%28%28lib._.Trading.D.S.L%2Fmain..rkt%29._compose-strategies%29%29" class="RktStxDef RktStxLink" data-pltdoc="x">compose-strategies</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">strategy1</span><span class="hspace">&nbsp;</span><span class="RktVar">strategy2</span><span class="hspace">&nbsp;</span><span class="RktPn">[</span><span class="RktPn">#:weights</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktVar">w1</span><span class="hspace">&nbsp;</span><span class="RktVar">w2</span><span class="RktPn">)</span><span class="RktPn">]</span><span class="RktPn">)</span></p></blockquote></td></tr></table></blockquote></div><div class="SIntrapara">Creates a new strategy that combines the allocations from <span class="RktVar">strategy1</span> and <span class="RktVar">strategy2</span> according to the weights <span class="RktVar">w1</span> and <span class="RktVar">w2</span>.</div></p><p>If weights are not provided, a default 50/50 split is used. The resulting strategy is valid only during the period where both input strategies are active.</p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>syntax</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(form._((lib._.Trading.D.S.L/main..rkt)._backtest))"></a><span title="Provided from: TradingDSL | Package: TradingDSL"><span class="RktSym"><a href="file:///Users/smarant/Documents/University%20stuff/Spring%202025/CS%203620%20-%20HYOL/TradingDSL/main.html#%28form._%28%28lib._.Trading.D.S.L%2Fmain..rkt%29._backtest%29%29" class="RktStxDef RktStxLink" data-pltdoc="x">backtest</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">strategy</span><span class="hspace">&nbsp;</span><span class="RktVar">start-date</span><span class="hspace">&nbsp;</span><span class="RktVar">end-date</span><span class="hspace">&nbsp;</span><span class="RktVar">top-n</span><span class="RktPn">)</span></p></blockquote></td></tr></table></blockquote></div><div class="SIntrapara">Backtests <span class="RktVar">strategy</span> from <span class="RktVar">start-date</span> to <span class="RktVar">end-date</span>, considering the top <span class="RktVar">top-n</span> stocks for investment.</div></p><p>Compile-time checks ensure that the backtest period is within the strategy&rsquo;s active period, and that the end date is not before the start date.</p><h3 class="heading">4<tt>&nbsp;</tt><a name="(part._.Function-.Based_.Interface)"></a>Function-Based Interface<span class="button-group"><a href="#(part._.Function-.Based_.Interface)" class="heading-anchor" title="Link to here">ðŸ”—</a><span style="visibility: hidden"> </span></span></h3><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><table cellspacing="0" cellpadding="0" class="prototype RForeground"><tr><td valign="top"><span class="RktPn">(</span><a name="(def._((lib._.Trading.D.S.L/main..rkt)._strategy))"></a><span title="Provided from: TradingDSL | Package: TradingDSL"><span class="RktSym"><a href="file:///Users/smarant/Documents/University%20stuff/Spring%202025/CS%203620%20-%20HYOL/TradingDSL/main.html#%28def._%28%28lib._.Trading.D.S.L%2Fmain..rkt%29._strategy%29%29" class="RktValDef RktValLink" data-pltdoc="x">strategy</a></span></span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktVar">strat-fn</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktPn">#:from</span><span class="hspace">&nbsp;</span><span class="RktVar">from-date</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktPn">#:to</span><span class="hspace">&nbsp;</span><span class="RktVar">to-date</span><span class="RktPn">)</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top">&rarr;</td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktSym"><span class="badlink"><span class="RktValLink">any</span></span></span></td></tr></table></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">strat-fn</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><span class="badlink"><span class="RktValLink">-&gt;</span></span></span><span class="hspace">&nbsp;</span><span class="RktSym"><span class="badlink"><span class="RktValLink">any/c</span></span></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><span class="badlink"><span class="RktValLink">listof</span></span></span><span class="hspace">&nbsp;</span><span class="RktSym">ticker-weight?</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">from-date</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><span class="badlink"><span class="RktValLink">string?</span></span></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">to-date</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><span class="badlink"><span class="RktValLink">string?</span></span></span></td></tr></table></blockquote></div><div class="SIntrapara">Creates a new strategy specification from <span class="RktVar">strat-fn</span>, active from <span class="RktVar">from-date</span> to <span class="RktVar">to-date</span>.</div></p><p>Unlike the macro version, validation occurs at runtime. If the end date is before the start date, an error is raised when the function is called.</p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._.Trading.D.S.L/main..rkt)._combined-strategy))"></a><span title="Provided from: TradingDSL | Package: TradingDSL"><span class="RktSym"><a href="file:///Users/smarant/Documents/University%20stuff/Spring%202025/CS%203620%20-%20HYOL/TradingDSL/main.html#%28def._%28%28lib._.Trading.D.S.L%2Fmain..rkt%29._combined-strategy%29%29" class="RktValDef RktValLink" data-pltdoc="x">combined-strategy</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">s1</span><span class="hspace">&nbsp;</span><span class="RktVar">s2</span><span class="hspace">&nbsp;</span><span class="RktPn">#:mid</span><span class="hspace">&nbsp;</span><span class="RktVar">mid-date</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><span class="badlink"><span class="RktValLink">any</span></span></span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">s1</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><span class="badlink"><span class="RktValLink">any</span></span></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">s2</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><span class="badlink"><span class="RktValLink">any</span></span></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">mid-date</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><span class="badlink"><span class="RktValLink">string?</span></span></span></td></tr></table></blockquote></div><div class="SIntrapara">Creates a new strategy that uses <span class="RktVar">s1</span> up to <span class="RktVar">mid-date</span> and then switches to <span class="RktVar">s2</span>.</div></p><p>Runtime checks verify that the strategies can be combined (i.e., their periods overlap).</p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><table cellspacing="0" cellpadding="0" class="prototype RForeground"><tr><td valign="top"><span class="RktPn">(</span><a name="(def._((lib._.Trading.D.S.L/main..rkt)._compose-strategies-fn))"></a><span title="Provided from: TradingDSL | Package: TradingDSL"><span class="RktSym"><a href="file:///Users/smarant/Documents/University%20stuff/Spring%202025/CS%203620%20-%20HYOL/TradingDSL/main.html#%28def._%28%28lib._.Trading.D.S.L%2Fmain..rkt%29._compose-strategies-fn%29%29" class="RktValDef RktValLink" data-pltdoc="x">compose-strategies-fn</a></span></span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktVar">s1</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktVar">s2</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span><span class="RktOpt">[</span></td><td valign="top"><span class="RktPn">#:weights</span><span class="hspace">&nbsp;</span><span class="RktVar">weights</span><span class="RktOpt">]</span><span class="RktPn">)</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top">&rarr;</td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktSym"><span class="badlink"><span class="RktValLink">any</span></span></span></td></tr></table></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">s1</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><span class="badlink"><span class="RktValLink">any</span></span></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">s2</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><span class="badlink"><span class="RktValLink">any</span></span></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">weights</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><span class="badlink"><span class="RktValLink">list/c</span></span></span><span class="hspace">&nbsp;</span><span class="RktSym"><span class="badlink"><span class="RktValLink">number?</span></span></span><span class="hspace">&nbsp;</span><span class="RktSym"><span class="badlink"><span class="RktValLink">number?</span></span></span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">(</span><span class="RktVal">0.5</span><span class="hspace">&nbsp;</span><span class="RktVal">0.5</span><span class="RktVal">)</span></td></tr></table></blockquote></div><div class="SIntrapara">Creates a new strategy by combining <span class="RktVar">s1</span> and <span class="RktVar">s2</span> according to the provided <span class="RktVar">weights</span>.</div></p><p>Runtime checks verify that the strategies have overlapping active periods.</p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._.Trading.D.S.L/main..rkt)._backtest-fn))"></a><span title="Provided from: TradingDSL | Package: TradingDSL"><span class="RktSym"><a href="file:///Users/smarant/Documents/University%20stuff/Spring%202025/CS%203620%20-%20HYOL/TradingDSL/main.html#%28def._%28%28lib._.Trading.D.S.L%2Fmain..rkt%29._backtest-fn%29%29" class="RktValDef RktValLink" data-pltdoc="x">backtest-fn</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">s</span><span class="hspace">&nbsp;</span><span class="RktVar">start-date</span><span class="hspace">&nbsp;</span><span class="RktVar">end-date</span><span class="hspace">&nbsp;</span><span class="RktVar">n-val</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><span class="badlink"><span class="RktValLink">any</span></span></span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">s</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><span class="badlink"><span class="RktValLink">any</span></span></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">start-date</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><span class="badlink"><span class="RktValLink">string?</span></span></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">end-date</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><span class="badlink"><span class="RktValLink">string?</span></span></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">n-val</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><span class="badlink"><span class="RktValLink">number?</span></span></span></td></tr></table></blockquote></div><div class="SIntrapara">Backtests strategy <span class="RktVar">s</span> from <span class="RktVar">start-date</span> to <span class="RktVar">end-date</span>, considering the top <span class="RktVar">n-val</span> stocks.</div></p><p>Runtime checks verify that the backtest period is within the strategy&rsquo;s active period.</p><h3 class="heading">5<tt>&nbsp;</tt><a name="(part._.Strategy_.Building_.Blocks)"></a>Strategy Building Blocks<span class="button-group"><a href="#(part._.Strategy_.Building_.Blocks)" class="heading-anchor" title="Link to here">ðŸ”—</a><span style="visibility: hidden"> </span></span></h3><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._.Trading.D.S.L/main..rkt)._top-performer))"></a><span title="Provided from: TradingDSL | Package: TradingDSL"><span class="RktSym"><a href="file:///Users/smarant/Documents/University%20stuff/Spring%202025/CS%203620%20-%20HYOL/TradingDSL/main.html#%28def._%28%28lib._.Trading.D.S.L%2Fmain..rkt%29._top-performer%29%29" class="RktValDef RktValLink" data-pltdoc="x">top-performer</a></span></span><span class="hspace">&nbsp;</span><span class="RktPn">#:period</span><span class="hspace">&nbsp;</span><span class="RktVar">period</span><span class="RktPn">)</span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><span class="badlink"><span class="RktValLink">-&gt;</span></span></span><span class="hspace">&nbsp;</span><span class="RktSym"><span class="badlink"><span class="RktValLink">any/c</span></span></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><span class="badlink"><span class="RktValLink">listof</span></span></span><span class="hspace">&nbsp;</span><span class="RktSym">ticker-weight?</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">period</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><span class="badlink"><span class="RktValLink">number?</span></span></span></td></tr></table></blockquote></div><div class="SIntrapara">Creates a momentum-based strategy that selects stocks with the highest price increase over the specified <span class="RktVar">period</span> (in days).</div></p><p>The returned function takes a date and returns a sorted list of <span class="RktSym"><a href="file:///Users/smarant/Documents/University%20stuff/Spring%202025/CS%203620%20-%20HYOL/TradingDSL/main.html#%28def._%28%28lib._.Trading.D.S.L%2Fmain..rkt%29._ticker-weight%29%29" class="RktValLink" data-pltdoc="x">ticker-weight</a></span> structures, with higher weights for better-performing stocks.</p><h3 class="heading">6<tt>&nbsp;</tt><a name="(part._.Data_.Structures)"></a>Data Structures<span class="button-group"><a href="#(part._.Data_.Structures)" class="heading-anchor" title="Link to here">ðŸ”—</a><span style="visibility: hidden"> </span></span></h3><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>struct</p></div></div><table cellspacing="0" cellpadding="0" class="RForeground"><tr><td><span class="RktPn">(</span><span class="RktSym"><span class="badlink"><span class="RktValLink">struct</span></span></span></td><td><span class="hspace">&nbsp;</span></td><td><a name="(def._((lib._.Trading.D.S.L/main..rkt)._ticker-weight-weight))"></a><a name="(def._((lib._.Trading.D.S.L/main..rkt)._ticker-weight-ticker))"></a><a name="(def._((lib._.Trading.D.S.L/main..rkt)._make-ticker-weight))"></a><a name="(def._((lib._.Trading.D.S.L/main..rkt)._ticker-weight~3f))"></a><a name="(def._((lib._.Trading.D.S.L/main..rkt)._struct~3aticker-weight))"></a><a name="(def._((lib._.Trading.D.S.L/main..rkt)._ticker-weight))"></a><span title="Provided from: TradingDSL | Package: TradingDSL"><span class="RktSym"><a href="file:///Users/smarant/Documents/University%20stuff/Spring%202025/CS%203620%20-%20HYOL/TradingDSL/main.html#%28def._%28%28lib._.Trading.D.S.L%2Fmain..rkt%29._ticker-weight%29%29" class="RktValDef RktValLink" data-pltdoc="x">ticker-weight</a></span></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">ticker</span><span class="stt"> </span><span class="RktSym">weight</span><span class="RktPn">)</span></td></tr></table></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">#:extra-constructor-name</span><span class="hspace">&nbsp;</span><span class="RktSym">make-ticker-weight</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktSym">ticker</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><span class="badlink"><span class="RktValLink">string?</span></span></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktSym">weight</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><span class="badlink"><span class="RktValLink">number?</span></span></span></td></tr></table></blockquote></div><div class="SIntrapara">Represents a stock ticker and its weight in a portfolio allocation.</div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>struct</p></div></div><table cellspacing="0" cellpadding="0" class="RForeground"><tr><td><span class="RktPn">(</span><span class="RktSym"><span class="badlink"><span class="RktValLink">struct</span></span></span></td><td><span class="hspace">&nbsp;</span></td><td><a name="(def._((lib._.Trading.D.S.L/main..rkt)._reduced-date-day))"></a><a name="(def._((lib._.Trading.D.S.L/main..rkt)._reduced-date-month))"></a><a name="(def._((lib._.Trading.D.S.L/main..rkt)._reduced-date-year))"></a><a name="(def._((lib._.Trading.D.S.L/main..rkt)._make-reduced-date))"></a><a name="(def._((lib._.Trading.D.S.L/main..rkt)._reduced-date~3f))"></a><a name="(def._((lib._.Trading.D.S.L/main..rkt)._struct~3areduced-date))"></a><a name="(def._((lib._.Trading.D.S.L/main..rkt)._reduced-date))"></a><span title="Provided from: TradingDSL | Package: TradingDSL"><span class="RktSym"><a href="file:///Users/smarant/Documents/University%20stuff/Spring%202025/CS%203620%20-%20HYOL/TradingDSL/main.html#%28def._%28%28lib._.Trading.D.S.L%2Fmain..rkt%29._reduced-date%29%29" class="RktValDef RktValLink" data-pltdoc="x">reduced-date</a></span></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">year</span><span class="stt"> </span><span class="RktSym">month</span><span class="stt"> </span><span class="RktSym">day</span><span class="RktPn">)</span></td></tr></table></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">#:extra-constructor-name</span><span class="hspace">&nbsp;</span><span class="RktSym">make-reduced-date</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktSym">year</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><span class="badlink"><span class="RktValLink">number?</span></span></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktSym">month</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><span class="badlink"><span class="RktValLink">number?</span></span></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktSym">day</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><span class="badlink"><span class="RktValLink">number?</span></span></span></td></tr></table></blockquote></div><div class="SIntrapara">A lightweight date representation used throughout the DSL.</div></p><h3 class="heading">7<tt>&nbsp;</tt><a name="(part._.Time_.Period_.Constants)"></a>Time Period Constants<span class="button-group"><a href="#(part._.Time_.Period_.Constants)" class="heading-anchor" title="Link to here">ðŸ”—</a><span style="visibility: hidden"> </span></span></h3><p>For convenience, the DSL provides several predefined time period constants (in days):</p><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><table cellspacing="0" cellpadding="0" class="together"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>value</p></div></div><p class="RForeground"><a name="(def._((lib._.Trading.D.S.L/main..rkt)._1y))"></a><span title="Provided from: TradingDSL | Package: TradingDSL"><span class="RktSym"><a href="file:///Users/smarant/Documents/University%20stuff/Spring%202025/CS%203620%20-%20HYOL/TradingDSL/main.html#%28def._%28%28lib._.Trading.D.S.L%2Fmain..rkt%29._1y%29%29" class="RktValDef RktValLink" data-pltdoc="x">1y</a></span></span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><span class="badlink"><span class="RktValLink">number?</span></span></span><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span><span class="RktVal">365</span></p></blockquote></td></tr></table></td></tr><tr><td><table cellspacing="0" cellpadding="0" class="together"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>value</p></div></div><p class="RForeground"><a name="(def._((lib._.Trading.D.S.L/main..rkt)._6m))"></a><span title="Provided from: TradingDSL | Package: TradingDSL"><span class="RktSym"><a href="file:///Users/smarant/Documents/University%20stuff/Spring%202025/CS%203620%20-%20HYOL/TradingDSL/main.html#%28def._%28%28lib._.Trading.D.S.L%2Fmain..rkt%29._6m%29%29" class="RktValDef RktValLink" data-pltdoc="x">6m</a></span></span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><span class="badlink"><span class="RktValLink">number?</span></span></span><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span><span class="RktVal">182</span></p></blockquote></td></tr></table></td></tr><tr><td><table cellspacing="0" cellpadding="0" class="together"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>value</p></div></div><p class="RForeground"><a name="(def._((lib._.Trading.D.S.L/main..rkt)._3m))"></a><span title="Provided from: TradingDSL | Package: TradingDSL"><span class="RktSym"><a href="file:///Users/smarant/Documents/University%20stuff/Spring%202025/CS%203620%20-%20HYOL/TradingDSL/main.html#%28def._%28%28lib._.Trading.D.S.L%2Fmain..rkt%29._3m%29%29" class="RktValDef RktValLink" data-pltdoc="x">3m</a></span></span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><span class="badlink"><span class="RktValLink">number?</span></span></span><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span><span class="RktVal">90</span></p></blockquote></td></tr></table></td></tr><tr><td><table cellspacing="0" cellpadding="0" class="together"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>value</p></div></div><p class="RForeground"><a name="(def._((lib._.Trading.D.S.L/main..rkt)._1m))"></a><span title="Provided from: TradingDSL | Package: TradingDSL"><span class="RktSym"><a href="file:///Users/smarant/Documents/University%20stuff/Spring%202025/CS%203620%20-%20HYOL/TradingDSL/main.html#%28def._%28%28lib._.Trading.D.S.L%2Fmain..rkt%29._1m%29%29" class="RktValDef RktValLink" data-pltdoc="x">1m</a></span></span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><span class="badlink"><span class="RktValLink">number?</span></span></span><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span><span class="RktVal">30</span></p></blockquote></td></tr></table></td></tr><tr><td><table cellspacing="0" cellpadding="0" class="together"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>value</p></div></div><p class="RForeground"><a name="(def._((lib._.Trading.D.S.L/main..rkt)._2w))"></a><span title="Provided from: TradingDSL | Package: TradingDSL"><span class="RktSym"><a href="file:///Users/smarant/Documents/University%20stuff/Spring%202025/CS%203620%20-%20HYOL/TradingDSL/main.html#%28def._%28%28lib._.Trading.D.S.L%2Fmain..rkt%29._2w%29%29" class="RktValDef RktValLink" data-pltdoc="x">2w</a></span></span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><span class="badlink"><span class="RktValLink">number?</span></span></span><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span><span class="RktVal">14</span></p></blockquote></td></tr></table></td></tr><tr><td><table cellspacing="0" cellpadding="0" class="together"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>value</p></div></div><p class="RForeground"><a name="(def._((lib._.Trading.D.S.L/main..rkt)._1w))"></a><span title="Provided from: TradingDSL | Package: TradingDSL"><span class="RktSym"><a href="file:///Users/smarant/Documents/University%20stuff/Spring%202025/CS%203620%20-%20HYOL/TradingDSL/main.html#%28def._%28%28lib._.Trading.D.S.L%2Fmain..rkt%29._1w%29%29" class="RktValDef RktValLink" data-pltdoc="x">1w</a></span></span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><span class="badlink"><span class="RktValLink">number?</span></span></span><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span><span class="RktVal">7</span></p></blockquote></td></tr></table></td></tr><tr><td><table cellspacing="0" cellpadding="0" class="together"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>value</p></div></div><p class="RForeground"><a name="(def._((lib._.Trading.D.S.L/main..rkt)._5d))"></a><span title="Provided from: TradingDSL | Package: TradingDSL"><span class="RktSym"><a href="file:///Users/smarant/Documents/University%20stuff/Spring%202025/CS%203620%20-%20HYOL/TradingDSL/main.html#%28def._%28%28lib._.Trading.D.S.L%2Fmain..rkt%29._5d%29%29" class="RktValDef RktValLink" data-pltdoc="x">5d</a></span></span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><span class="badlink"><span class="RktValLink">number?</span></span></span><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span><span class="RktVal">5</span></p></blockquote></td></tr></table></td></tr><tr><td><table cellspacing="0" cellpadding="0" class="together"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>value</p></div></div><p class="RForeground"><a name="(def._((lib._.Trading.D.S.L/main..rkt)._1d))"></a><span title="Provided from: TradingDSL | Package: TradingDSL"><span class="RktSym"><a href="file:///Users/smarant/Documents/University%20stuff/Spring%202025/CS%203620%20-%20HYOL/TradingDSL/main.html#%28def._%28%28lib._.Trading.D.S.L%2Fmain..rkt%29._1d%29%29" class="RktValDef RktValLink" data-pltdoc="x">1d</a></span></span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><span class="badlink"><span class="RktValLink">number?</span></span></span><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span><span class="RktVal">1</span></p></blockquote></td></tr></table></td></tr></table></blockquote><h3 class="heading">8<tt>&nbsp;</tt><a name="(part._.Visualization_.Functions)"></a>Visualization Functions<span class="button-group"><a href="#(part._.Visualization_.Functions)" class="heading-anchor" title="Link to here">ðŸ”—</a><span style="visibility: hidden"> </span></span></h3><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><table cellspacing="0" cellpadding="0" class="prototype RForeground"><tr><td valign="top"><span class="RktPn">(</span><a name="(def._((lib._.Trading.D.S.L/main..rkt)._display-strategy-allocation))"></a><span title="Provided from: TradingDSL | Package: TradingDSL"><span class="RktSym"><a href="file:///Users/smarant/Documents/University%20stuff/Spring%202025/CS%203620%20-%20HYOL/TradingDSL/main.html#%28def._%28%28lib._.Trading.D.S.L%2Fmain..rkt%29._display-strategy-allocation%29%29" class="RktValDef RktValLink" data-pltdoc="x">display-strategy-allocation</a></span></span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktVar">strategy</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktVar">date</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktVar">top-n</span><span class="RktPn">)</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top">&rarr;</td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktSym"><span class="badlink"><span class="RktValLink">void?</span></span></span></td></tr></table></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">strategy</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><span class="badlink"><span class="RktValLink">-&gt;</span></span></span><span class="hspace">&nbsp;</span><span class="RktSym"><span class="badlink"><span class="RktValLink">any/c</span></span></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><span class="badlink"><span class="RktValLink">listof</span></span></span><span class="hspace">&nbsp;</span><span class="RktSym">ticker-weight?</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">date</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><span class="badlink"><span class="RktValLink">any/c</span></span></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">top-n</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><span class="badlink"><span class="RktValLink">number?</span></span></span></td></tr></table></blockquote></div><div class="SIntrapara">Displays the top <span class="RktVar">top-n</span> stocks and their weights for <span class="RktVar">strategy</span> on the specified <span class="RktVar">date</span>.</div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><table cellspacing="0" cellpadding="0" class="prototype RForeground"><tr><td valign="top"><span class="RktPn">(</span><a name="(def._((lib._.Trading.D.S.L/main..rkt)._display-strategy-comparison))"></a><span title="Provided from: TradingDSL | Package: TradingDSL"><span class="RktSym"><a href="file:///Users/smarant/Documents/University%20stuff/Spring%202025/CS%203620%20-%20HYOL/TradingDSL/main.html#%28def._%28%28lib._.Trading.D.S.L%2Fmain..rkt%29._display-strategy-comparison%29%29" class="RktValDef RktValLink" data-pltdoc="x">display-strategy-comparison</a></span></span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktVar">strategies</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktVar">strategy-names</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktVar">date</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktVar">top-n</span><span class="RktPn">)</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top">&rarr;</td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktSym"><span class="badlink"><span class="RktValLink">void?</span></span></span></td></tr></table></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">strategies</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><span class="badlink"><span class="RktValLink">listof</span></span></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><span class="badlink"><span class="RktValLink">-&gt;</span></span></span><span class="hspace">&nbsp;</span><span class="RktSym"><span class="badlink"><span class="RktValLink">any/c</span></span></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><span class="badlink"><span class="RktValLink">listof</span></span></span><span class="hspace">&nbsp;</span><span class="RktSym">ticker-weight?</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">strategy-names</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><span class="badlink"><span class="RktValLink">listof</span></span></span><span class="hspace">&nbsp;</span><span class="RktSym"><span class="badlink"><span class="RktValLink">string?</span></span></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">date</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><span class="badlink"><span class="RktValLink">any/c</span></span></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">top-n</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><span class="badlink"><span class="RktValLink">number?</span></span></span></td></tr></table></blockquote></div><div class="SIntrapara">Compares multiple strategies on a specific date, showing the top pick for each.</div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><table cellspacing="0" cellpadding="0" class="prototype RForeground"><tr><td valign="top"><span class="RktPn">(</span><a name="(def._((lib._.Trading.D.S.L/main..rkt)._display-allocation-difference))"></a><span title="Provided from: TradingDSL | Package: TradingDSL"><span class="RktSym"><a href="file:///Users/smarant/Documents/University%20stuff/Spring%202025/CS%203620%20-%20HYOL/TradingDSL/main.html#%28def._%28%28lib._.Trading.D.S.L%2Fmain..rkt%29._display-allocation-difference%29%29" class="RktValDef RktValLink" data-pltdoc="x">display-allocation-difference</a></span></span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktVar">strat1</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktVar">strat2</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktVar">name1</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktVar">name2</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktVar">date</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktVar">top-n</span><span class="RktPn">)</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top">&rarr;</td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktSym"><span class="badlink"><span class="RktValLink">void?</span></span></span></td></tr></table></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">strat1</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><span class="badlink"><span class="RktValLink">-&gt;</span></span></span><span class="hspace">&nbsp;</span><span class="RktSym"><span class="badlink"><span class="RktValLink">any/c</span></span></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><span class="badlink"><span class="RktValLink">listof</span></span></span><span class="hspace">&nbsp;</span><span class="RktSym">ticker-weight?</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">strat2</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><span class="badlink"><span class="RktValLink">-&gt;</span></span></span><span class="hspace">&nbsp;</span><span class="RktSym"><span class="badlink"><span class="RktValLink">any/c</span></span></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><span class="badlink"><span class="RktValLink">listof</span></span></span><span class="hspace">&nbsp;</span><span class="RktSym">ticker-weight?</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">name1</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><span class="badlink"><span class="RktValLink">string?</span></span></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">name2</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><span class="badlink"><span class="RktValLink">string?</span></span></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">date</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><span class="badlink"><span class="RktValLink">any/c</span></span></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">top-n</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><span class="badlink"><span class="RktValLink">number?</span></span></span></td></tr></table></blockquote></div><div class="SIntrapara">Compares the allocations of two strategies, highlighting the differences in weights between them.</div></p></div></div><div id="contextindicator">&nbsp;</div></body></html>